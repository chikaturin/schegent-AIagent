from config.llm import llm
from langchain.prompts import PromptTemplate
from langchain.chains import LLMChain
from agents.tool.interface.index import State
import json

events = [
    {
        "DayOfWeek": "Monday",
        "title": "T·∫≠p th·ªÉ d·ª•c bu·ªïi s√°ng",
        "description": "Kh·ªüi ƒë·ªông ng√†y m·ªõi v·ªõi b√†i t·∫≠p nh·∫π nh√†ng.",
        "location": "Nh√†",
        "start_time": "2024-07-01T06:00:00",
        "end_time": "2024-07-01T06:30:00",
        "icon": "üßò‚Äç‚ôÄÔ∏è",
        "priority": "medium",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Monday",
        "title": "ƒÇn s√°ng",
        "description": "B·ªØa s√°ng chay l√†nh m·∫°nh.",
        "location": "Nh√†",
        "start_time": "2024-07-01T06:30:00",
        "end_time": "2024-07-01T07:00:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Monday",
        "title": "H·ªçc t·∫≠p",
        "description": "H·ªçc c√°c m√¥n quan tr·ªçng.",
        "location": "Th∆∞ vi·ªán",
        "start_time": "2024-07-01T07:00:00",
        "end_time": "2024-07-01T11:00:00",
        "icon": "üìö",
        "priority": "high",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Monday",
        "title": "Ngh·ªâ ng∆°i",
        "description": "Ngh·ªâ ng∆°i gi·ªØa bu·ªïi h·ªçc.",
        "location": "Qu√°n cafe",
        "start_time": "2024-07-01T11:00:00",
        "end_time": "2024-07-01T11:30:00",
        "icon": "‚òï",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Monday",
        "title": "ƒÇn tr∆∞a",
        "description": "B·ªØa tr∆∞a chay.",
        "location": "Nh√†",
        "start_time": "2024-07-01T11:30:00",
        "end_time": "2024-07-01T12:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Monday",
        "title": "L√†m vi·ªác",
        "description": "Gi·∫£i quy·∫øt c√¥ng vi·ªác.",
        "location": "VƒÉn ph√≤ng",
        "start_time": "2024-07-01T12:30:00",
        "end_time": "2024-07-01T17:00:00",
        "icon": "üíº",
        "priority": "medium",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Monday",
        "title": "Ngh·ªâ ng∆°i",
        "description": "ƒêi d·∫°o th∆∞ gi√£n.",
        "location": "C√¥ng vi√™n",
        "start_time": "2024-07-01T17:00:00",
        "end_time": "2024-07-01T17:30:00",
        "icon": "üö∂‚Äç‚ôÄÔ∏è",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Monday",
        "title": "ƒÇn t·ªëi",
        "description": "B·ªØa t·ªëi chay nh·∫π nh√†ng.",
        "location": "Nh√†",
        "start_time": "2024-07-01T18:30:00",
        "end_time": "2024-07-01T19:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Monday",
        "title": "ƒê·ªçc s√°ch",
        "description": "ƒê·ªçc s√°ch tr∆∞·ªõc khi ng·ªß.",
        "location": "Ph√≤ng ng·ªß",
        "start_time": "2024-07-01T21:30:00",
        "end_time": "2024-07-01T22:30:00",
        "icon": "üìñ",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Tuesday",
        "title": "Ng√†y vui ch∆°i",
        "description": "T·∫≠n h∆∞·ªüng tr·ªçn v·∫πn m·ªôt ng√†y vui v·∫ª.",
        "location": "Kh√¥ng x√°c ƒë·ªãnh",
        "start_time": "2024-07-02T06:00:00",
        "end_time": "2024-07-02T23:00:00",
        "icon": "üéâ",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Wednesday",
        "title": "T·∫≠p th·ªÉ d·ª•c bu·ªïi s√°ng",
        "description": "Kh·ªüi ƒë·ªông ng√†y m·ªõi v·ªõi b√†i t·∫≠p nh·∫π nh√†ng.",
        "location": "Nh√†",
        "start_time": "2024-07-03T06:00:00",
        "end_time": "2024-07-03T06:30:00",
        "icon": "üßò‚Äç‚ôÄÔ∏è",
        "priority": "medium",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Wednesday",
        "title": "ƒÇn s√°ng",
        "description": "B·ªØa s√°ng chay l√†nh m·∫°nh.",
        "location": "Nh√†",
        "start_time": "2024-07-03T06:30:00",
        "end_time": "2024-07-03T07:00:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Wednesday",
        "title": "H·ªçc t·∫≠p",
        "description": "H·ªçc c√°c m√¥n quan tr·ªçng.",
        "location": "Th∆∞ vi·ªán",
        "start_time": "2024-07-03T07:00:00",
        "end_time": "2024-07-03T11:00:00",
        "icon": "üìö",
        "priority": "high",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Wednesday",
        "title": "Ngh·ªâ ng∆°i",
        "description": "Ngh·ªâ ng∆°i gi·ªØa bu·ªïi h·ªçc.",
        "location": "Qu√°n cafe",
        "start_time": "2024-07-03T11:00:00",
        "end_time": "2024-07-03T11:30:00",
        "icon": "‚òï",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Wednesday",
        "title": "ƒÇn tr∆∞a",
        "description": "B·ªØa tr∆∞a chay.",
        "location": "Nh√†",
        "start_time": "2024-07-03T11:30:00",
        "end_time": "2024-07-03T12:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Wednesday",
        "title": "L√†m vi·ªác",
        "description": "Gi·∫£i quy·∫øt c√¥ng vi·ªác.",
        "location": "VƒÉn ph√≤ng",
        "start_time": "2024-07-03T12:30:00",
        "end_time": "2024-07-03T17:00:00",
        "icon": "üíº",
        "priority": "medium",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Wednesday",
        "title": "Ngh·ªâ ng∆°i",
        "description": "ƒêi d·∫°o th∆∞ gi√£n.",
        "location": "C√¥ng vi√™n",
        "start_time": "2024-07-03T17:00:00",
        "end_time": "2024-07-03T17:30:00",
        "icon": "üö∂‚Äç‚ôÄÔ∏è",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Wednesday",
        "title": "ƒÇn t·ªëi",
        "description": "B·ªØa t·ªëi chay nh·∫π nh√†ng.",
        "location": "Nh√†",
        "start_time": "2024-07-03T18:30:00",
        "end_time": "2024-07-03T19:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Wednesday",
        "title": "ƒê·ªçc s√°ch",
        "description": "ƒê·ªçc s√°ch tr∆∞·ªõc khi ng·ªß.",
        "location": "Ph√≤ng ng·ªß",
        "start_time": "2024-07-03T21:30:00",
        "end_time": "2024-07-03T22:30:00",
        "icon": "üìñ",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Thursday",
        "title": "T·∫≠p th·ªÉ d·ª•c bu·ªïi s√°ng",
        "description": "Kh·ªüi ƒë·ªông ng√†y m·ªõi v·ªõi b√†i t·∫≠p nh·∫π nh√†ng.",
        "location": "Nh√†",
        "start_time": "2024-07-04T06:00:00",
        "end_time": "2024-07-04T06:30:00",
        "icon": "üßò‚Äç‚ôÄÔ∏è",
        "priority": "medium",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Thursday",
        "title": "ƒÇn s√°ng",
        "description": "B·ªØa s√°ng chay l√†nh m·∫°nh.",
        "location": "Nh√†",
        "start_time": "2024-07-04T06:30:00",
        "end_time": "2024-07-04T07:00:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Thursday",
        "title": "H·ªçc t·∫≠p",
        "description": "H·ªçc c√°c m√¥n quan tr·ªçng.",
        "location": "Th∆∞ vi·ªán",
        "start_time": "2024-07-04T07:00:00",
        "end_time": "2024-07-04T11:00:00",
        "icon": "üìö",
        "priority": "high",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Thursday",
        "title": "Ngh·ªâ ng∆°i",
        "description": "Ngh·ªâ ng∆°i gi·ªØa bu·ªïi h·ªçc.",
        "location": "Qu√°n cafe",
        "start_time": "2024-07-04T11:00:00",
        "end_time": "2024-07-04T11:30:00",
        "icon": "‚òï",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Thursday",
        "title": "ƒÇn tr∆∞a",
        "description": "B·ªØa tr∆∞a chay.",
        "location": "Nh√†",
        "start_time": "2024-07-04T11:30:00",
        "end_time": "2024-07-04T12:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Thursday",
        "title": "L√†m vi·ªác",
        "description": "Gi·∫£i quy·∫øt c√¥ng vi·ªác.",
        "location": "VƒÉn ph√≤ng",
        "start_time": "2024-07-04T12:30:00",
        "end_time": "2024-07-04T17:00:00",
        "icon": "üíº",
        "priority": "medium",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Thursday",
        "title": "Ngh·ªâ ng∆°i",
        "description": "ƒêi d·∫°o th∆∞ gi√£n.",
        "location": "C√¥ng vi√™n",
        "start_time": "2024-07-04T17:00:00",
        "end_time": "2024-07-04T17:30:00",
        "icon": "üö∂‚Äç‚ôÄÔ∏è",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Thursday",
        "title": "ƒÇn t·ªëi",
        "description": "B·ªØa t·ªëi chay nh·∫π nh√†ng.",
        "location": "Nh√†",
        "start_time": "2024-07-04T18:30:00",
        "end_time": "2024-07-04T19:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Thursday",
        "title": "ƒê·ªçc s√°ch",
        "description": "ƒê·ªçc s√°ch tr∆∞·ªõc khi ng·ªß.",
        "location": "Ph√≤ng ng·ªß",
        "start_time": "2024-07-04T21:30:00",
        "end_time": "2024-07-04T22:30:00",
        "icon": "üìñ",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Friday",
        "title": "T·∫≠p th·ªÉ d·ª•c bu·ªïi s√°ng",
        "description": "Kh·ªüi ƒë·ªông ng√†y m·ªõi v·ªõi b√†i t·∫≠p nh·∫π nh√†ng.",
        "location": "Nh√†",
        "start_time": "2024-07-05T06:00:00",
        "end_time": "2024-07-05T06:30:00",
        "icon": "üßò‚Äç‚ôÄÔ∏è",
        "priority": "medium",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Friday",
        "title": "ƒÇn s√°ng",
        "description": "B·ªØa s√°ng chay l√†nh m·∫°nh.",
        "location": "Nh√†",
        "start_time": "2024-07-05T06:30:00",
        "end_time": "2024-07-05T07:00:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Friday",
        "title": "H·ªçc t·∫≠p",
        "description": "H·ªçc c√°c m√¥n quan tr·ªçng.",
        "location": "Th∆∞ vi·ªán",
        "start_time": "2024-07-05T07:00:00",
        "end_time": "2024-07-05T11:00:00",
        "icon": "üìö",
        "priority": "high",
        "event_category": "habit",
    },
    {
        "DayOfWeek": "Friday",
        "title": "Ngh·ªâ ng∆°i",
        "description": "Ngh·ªâ ng∆°i gi·ªØa bu·ªïi h·ªçc.",
        "location": "Qu√°n cafe",
        "start_time": "2024-07-05T11:00:00",
        "end_time": "2024-07-05T11:30:00",
        "icon": "‚òï",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Friday",
        "title": "ƒÇn tr∆∞a",
        "description": "B·ªØa tr∆∞a chay.",
        "location": "Nh√†",
        "start_time": "2024-07-05T11:30:00",
        "end_time": "2024-07-05T12:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Friday",
        "title": "L√†m vi·ªác",
        "description": "Gi·∫£i quy·∫øt c√¥ng vi·ªác.",
        "location": "VƒÉn ph√≤ng",
        "start_time": "2024-07-05T12:30:00",
        "end_time": "2024-07-05T17:00:00",
        "icon": "üíº",
        "priority": "medium",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Friday",
        "title": "Ngh·ªâ ng∆°i",
        "description": "ƒêi d·∫°o th∆∞ gi√£n.",
        "location": "C√¥ng vi√™n",
        "start_time": "2024-07-05T17:00:00",
        "end_time": "2024-07-05T17:30:00",
        "icon": "üö∂‚Äç‚ôÄÔ∏è",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Friday",
        "title": "ƒÇn t·ªëi",
        "description": "B·ªØa t·ªëi chay nh·∫π nh√†ng.",
        "location": "Nh√†",
        "start_time": "2024-07-05T18:30:00",
        "end_time": "2024-07-05T19:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Friday",
        "title": "ƒê·ªçc s√°ch",
        "description": "ƒê·ªçc s√°ch tr∆∞·ªõc khi ng·ªß.",
        "location": "Ph√≤ng ng·ªß",
        "start_time": "2024-07-05T21:30:00",
        "end_time": "2024-07-05T22:30:00",
        "icon": "üìñ",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Saturday",
        "title": "T·∫≠p th·ªÉ d·ª•c nh·∫π nh√†ng",
        "description": "Yoga ho·∫∑c ƒëi b·ªô.",
        "location": "C√¥ng vi√™n",
        "start_time": "2024-07-06T07:00:00",
        "end_time": "2024-07-06T07:30:00",
        "icon": "üö∂‚Äç‚ôÄÔ∏è",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Saturday",
        "title": "ƒÇn s√°ng",
        "description": "B·ªØa s√°ng chay.",
        "location": "Nh√†",
        "start_time": "2024-07-06T07:30:00",
        "end_time": "2024-07-06T08:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Saturday",
        "title": "Th∆∞ gi√£n",
        "description": "Xem phim ho·∫∑c nghe nh·∫°c.",
        "location": "Nh√†",
        "start_time": "2024-07-06T08:30:00",
        "end_time": "2024-07-06T11:30:00",
        "icon": " relaxation",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Saturday",
        "title": "ƒÇn tr∆∞a",
        "description": "B·ªØa tr∆∞a chay.",
        "location": "Nh√†",
        "start_time": "2024-07-06T11:30:00",
        "end_time": "2024-07-06T12:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Saturday",
        "title": "ƒêi ch∆°i",
        "description": "G·∫∑p g·ª° b·∫°n b√®.",
        "location": "Qu√°n cafe",
        "start_time": "2024-07-06T14:00:00",
        "end_time": "2024-07-06T17:00:00",
        "icon": "‚òï",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Saturday",
        "title": "ƒÇn t·ªëi",
        "description": "B·ªØa t·ªëi chay.",
        "location": "Nh√†",
        "start_time": "2024-07-06T18:30:00",
        "end_time": "2024-07-06T19:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Saturday",
        "title": "ƒê·ªçc s√°ch",
        "description": "ƒê·ªçc s√°ch tr∆∞·ªõc khi ng·ªß.",
        "location": "Ph√≤ng ng·ªß",
        "start_time": "2024-07-06T21:30:00",
        "end_time": "2024-07-06T22:30:00",
        "icon": "üìñ",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Sunday",
        "title": "T·∫≠p th·ªÉ d·ª•c nh·∫π nh√†ng",
        "description": "Yoga ho·∫∑c ƒëi b·ªô.",
        "location": "C√¥ng vi√™n",
        "start_time": "2024-07-07T07:00:00",
        "end_time": "2024-07-07T07:30:00",
        "icon": "üö∂‚Äç‚ôÄÔ∏è",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Sunday",
        "title": "ƒÇn s√°ng",
        "description": "B·ªØa s√°ng chay.",
        "location": "Nh√†",
        "start_time": "2024-07-07T07:30:00",
        "end_time": "2024-07-07T08:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Sunday",
        "title": "Th∆∞ gi√£n",
        "description": "Xem phim ho·∫∑c nghe nh·∫°c.",
        "location": "Nh√†",
        "start_time": "2024-07-07T08:30:00",
        "end_time": "2024-07-07T11:30:00",
        "icon": " relaxation",
        "priority": "low",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Sunday",
        "title": "ƒÇn tr∆∞a",
        "description": "B·ªØa tr∆∞a chay.",
        "location": "Nh√†",
        "start_time": "2024-07-07T11:30:00",
        "end_time": "2024-07-07T12:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Sunday",
        "title": "T·ªïng k·∫øt tu·∫ßn",
        "description": "Xem l·∫°i nh·ªØng g√¨ ƒë√£ l√†m trong tu·∫ßn.",
        "location": "Nh√†",
        "start_time": "2024-07-07T14:00:00",
        "end_time": "2024-07-07T16:00:00",
        "icon": " reflection",
        "priority": "medium",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Sunday",
        "title": "ƒÇn t·ªëi",
        "description": "B·ªØa t·ªëi chay.",
        "location": "Nh√†",
        "start_time": "2024-07-07T18:30:00",
        "end_time": "2024-07-07T19:30:00",
        "icon": "üçΩÔ∏è",
        "priority": "high",
        "event_category": "general",
    },
    {
        "DayOfWeek": "Sunday",
        "title": "ƒê·ªçc s√°ch",
        "description": "ƒê·ªçc s√°ch tr∆∞·ªõc khi ng·ªß.",
        "location": "Ph√≤ng ng·ªß",
        "start_time": "2024-07-07T21:30:00",
        "end_time": "2024-07-07T22:30:00",
        "icon": "üìñ",
        "priority": "low",
        "event_category": "general",
    },
]


def genarate_habit_summarise(summarize_habits=False):
    print("Generating habit summary...")

    prompt_template = """
        B·∫°n l√† m·ªôt chuy√™n gia ph√¢n t√≠ch th√≥i quen h√†ng ng√†y c·ªßa ng∆∞·ªùi d√πng. Nhi·ªám v·ª• c·ªßa b·∫°n l√† t√≥m t·∫Øt c√°c th√≥i quen v√† s·ªü th√≠ch c·ªßa ng∆∞·ªùi d√πng d·ª±a tr√™n l·ªãch tr√¨nh ho·∫°t ƒë·ªông h√†ng tu·∫ßn.
       D·ª±a tr√™n l·ªãch tr√¨nh ho·∫°t ƒë·ªông h√†ng tu·∫ßn sau ƒë√¢y c·ªßa ng∆∞·ªùi d√πng, h√£y ph√¢n t√≠ch v√† tr√≠ch xu·∫•t c√°c nh√≥m ho·∫°t ƒë·ªông ch√≠nh m√† ng∆∞·ªùi d√πng th∆∞·ªùng th·ª±c hi·ªán, v√≠ d·ª• nh∆∞:
            ƒÇn u·ªëng

            H·ªçc t·∫≠p

            L√†m vi·ªác

            Gi·∫£i tr√≠ (bao g·ªìm ƒë·ªçc s√°ch, xem phim, ƒëi d·∫°o, ch∆°i game...)

            Ngh·ªâ ng∆°i

            G·∫∑p g·ª° b·∫°n b√® / ho·∫°t ƒë·ªông x√£ h·ªôi

            T·∫≠p th·ªÉ d·ª•c / chƒÉm s√≥c s·ª©c kh·ªèe

            V·ªõi m·ªói nh√≥m ho·∫°t ƒë·ªông, h√£y tr·∫£ v·ªÅ m·ªôt ƒë·ªëi t∆∞·ª£ng JSON v·ªõi c√°c th√¥ng tin sau:

            "Nh√≥m ho·∫°t ƒë·ªông": t√™n nh√≥m

            "T·∫ßn su·∫•t": s·ªë ng√†y trong tu·∫ßn xu·∫•t hi·ªán (ho·∫∑c c√°c ng√†y c·ª• th·ªÉ)

            "Th·ªùi ƒëi·ªÉm ∆∞u ti√™n": s√°ng / chi·ªÅu / t·ªëi / linh ho·∫°t

            "M·ª©c ƒë·ªô ∆∞u ti√™n t·ªïng th·ªÉ": cao / trung b√¨nh / th·∫•p

            "S·ªü th√≠ch t·ªïng qu√°t": th√≠ch / kh√¥ng th√≠ch / b√¨nh th∆∞·ªùng

            "Ghi ch√∫ ƒë·∫∑c bi·ªát": n·∫øu c√≥ s·ª± kh√°c bi·ªát theo ng√†y (v√≠ d·ª•: th√≠ch th∆∞ gi√£n nhi·ªÅu h∆°n v√†o cu·ªëi tu·∫ßn, h·ªçc t·∫≠p nhi·ªÅu v√†o Ch·ªß nh·∫≠t...)

            Ch·ªâ tr·∫£ v·ªÅ JSON, kh√¥ng c·∫ßn gi·∫£i th√≠ch th√™m.
            M·ª•c ti√™u l√† gi√∫p h·ªá th·ªëng hi·ªÉu th√≥i quen ng∆∞·ªùi d√πng ƒë·ªÉ t·ªëi ∆∞u l·ªãch tr√¨nh sau n√†y.
        L·ªãch tr√¨nh:
        {events}
    """

    prompt = PromptTemplate(input_variables=["events"], template=prompt_template)

    summary_chain = LLMChain(llm=llm, prompt=prompt)
    print("Habit summary generated.")
    return (
        summary_chain.run(events=json.dumps(events, ensure_ascii=False))
        if summarize_habits
        else "No habit summary requested."
    )


def emberding_rag(state: State):
    habit_summaries = genarate_habit_summarise(summarize_habits=True)
    print("Habit summaries generated.")
    print(habit_summaries)

    state["messages"].append(
        {
            "role": "assistant",
            "content": habit_summaries,
        }
    )
    return state
